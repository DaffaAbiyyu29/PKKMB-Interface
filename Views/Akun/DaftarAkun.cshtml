@{
	Layout = "_Layout";
}

<div class="row justify-content-center mb-5">
	<div class="col-lg-8">
		<div class="card">
			@*@Context.Session.GetString("Peran")*@
			<h5 class="card-header text-center white-text py-4 mb-4" style="background-color: #0059AB;">
				<strong>Daftar Akun</strong>
				<a class="btn" style="position: absolute; top: 11px; right: 10px; color: white;" asp-controller="akun" asp-action="login"><strong>X</strong></a>
			</h5>
			<div class="card-body px-lg-5 pt-1">
				@*<div class="mb-4">
				<p class="text-center">
				Untuk mendaftarkan akun, anda perlu menentukan
				</p>
				</div>*@

				<div class="form-floating mb-4">
					<select class="form-select" id="floatingSelect" name="tipeakun" aria-label="">
						<option selected disabled>Pilih Tipe Akun</option>
						<option value="Mahasiswa Baru">Mahasiswa Baru</option>
						<option value="Panitia Kesekretariatan">Panitia Kesekretariatan</option>
					</select>
					<label for="floatingSelect">Tipe Akun</label>
				</div>

				<div class="row">
					<div class="col-md-6">
						<!-- First Column -->
						<div class="form-floating mb-4 nim">
							<input type="text" class="form-control" maxlength="10" id="nim" name="nim" placeholder="">
							<label for="floatingInputGrid">NIM</label>
						</div>

						<div class="form-floating mb-4 nopendaftaran">
							<input type="text" class="form-control" maxlength="10" id="nopendaftaran" name="nopendaftaran" placeholder="">
							<label for="floatingInputGrid">No Pendaftaran</label>
						</div>

						<div class="form-floating mb-4 namalengkap">
							<input type="text" class="form-control" maxlength="10" id="namalengkap" name="namalengkap" placeholder="">
							<label for="floatingInputGrid">Nama Lengkap</label>
						</div>

						<div class="form-floating mb-4 jeniskelamin">
							<select class="form-select" id="jeniskelamin" name="jeniskelamin" aria-label="">
								<option selected>Pilih Jenis Kelamin</option>
								<option value="Laki-laki">Laki-laki</option>
								<option value="Perempuan">Perempuan</option>
							</select>
							<label for="floatingSelect">Jenis Kelamin</label>
						</div>

						<div class="form-floating mb-4 programstudi">
							<select class="form-select" id="programstudi" name="programstudi" aria-label="">
								<option selected disabled>Pilih Program Studi</option>
								<option value="Teknik Produksi dan Proses Manufaktur">Teknik Produksi dan Proses Manufaktur</option>
								<option value="Pembuatan Peralatan dan Perkakas Produksi">Pembuatan Peralatan dan Perkakas Produksi</option>
								<option value="Manajemen Informatika">Manajemen Informatika</option>
								<option value="Teknologi Konstruksi Bangunan Gedung">Teknologi Konstruksi Bangunan Gedung</option>
								<option value="Mekatronika">Mekatronika</option>
								<option value="Mesin Otomotif">Mesin Otomotif</option>
								<option value="Teknologi Rekayasa Pemeliharaan Alat Berat">Teknologi Rekayasa Pemeliharaan Alat Berat</option>
								<option value="Teknologi Rekayasa Logistik">Teknologi Rekayasa Logistik</option>
							</select>
							<label for="floatingSelect">Program Studi</label>
						</div>
						<div class="form-floating mb-4 alamat">
							<textarea class="form-control" placeholder="" id="alamat" name="alamat" style="height: 100px"></textarea>
							<label for="floatingTextarea2">Alamat</label>
						</div>
					</div>

					<div class="col-md-6">
						<!-- Second Column -->
						<div class="form-floating mb-4 notelepon">
							<input type="number" class="form-control" maxlength="13" id="notelepon" name="notelepon" placeholder="">
							<label for="floatingInputGrid">No Telepon</label>
						</div>

						<div class="form-floating mb-4 email">
							<input type="email" class="form-control" maxlength="50" id="email" name="email" placeholder="">
							<label for="floatingInputGrid">Email</label>
						</div>

						<div class="form-floating mb-4 kategori">
							<select class="form-select" id="kategori" name="kategori" aria-label="">
								<option selected>Pilih Kategori Mahasiswa</option>
								<option value="Beasiswa">Beasiswa</option>
								<option value="Regular">Regular</option>
							</select>
							<label for="floatingSelect">Kategori Mahasiswa</label>
						</div>

						<div class="form-floating mb-4 role">
							<select class="form-select" id="role" name="role" aria-label="">
								<option selected>Pilih Role</option>
								<option value="KSK">KSK</option>
								<option value="Fasilitator">Fasilitator</option>
							</select>
							<label for="floatingSelect">Role Panitia Kesekretariatan</label>
						</div>

						<div class="form-floating mb-4 katasandi">
							<input type="password" class="form-control" maxlength="30" id="katasandi" name="katasandi" placeholder="">
							<label for="floatingInputGrid">Kata Sandi</label>
						</div>

						<div class="form-floating mb-4 katasandi2">
							<input type="password" class="form-control" maxlength="30" id="katasandi2" name="katasandi2" placeholder="">
							<label for="floatingInputGrid">Ketik Ulang Kata Sandi</label>
						</div>
					</div>
				</div>
				<div class="d-flex justify-content-around mb-1 my-5">
					<div>
						Sudah Memiliki Akun? <a asp-controller="akun" asp-action="login" class="font-weight-bold">Login Disini</a>
					</div>
				</div>
				<button class="btn btn-rounded btn-block my-3 mb-4 white-text font-weight-bold waves-effect z-depth-0" Style="background-color: #0059AB;" onclick="daftarakun(event)">Daftar</button>
			</div>
		</div>
	</div>
</div>


<script>
	$('.nim').hide();
	$('.nopendaftaran').hide();
	$('.namalengkap').hide();
	$('.jeniskelamin').hide();
	$('.programstudi').hide();
	$('.alamat').hide();
	$('.notelepon').hide();
	$('.email').hide();
	$('.kategori').hide();
	$('.role').hide();
	$('.katasandi').hide();
	$('.katasandi2').hide();

	// Add an event listener to the tipeakun dropdown
	$(document).ready(function () {
		$('[name="tipeakun"]').change(function () {
			// Get the selected value
			var selectedTipeAkun = $(this).val();

			// Toggle visibility based on the selected account type
			if (selectedTipeAkun === 'Mahasiswa Baru') {
				$('.nim').hide();
				$('.nopendaftaran').show();
				$('.namalengkap').show();
				$('.jeniskelamin').show();
				$('.programstudi').show();
				$('.alamat').show();
				$('.notelepon').show();
				$('.email').show();
				$('.kategori').show();
				$('.role').hide();
				$('.katasandi').show();
				$('.katasandi2').show();
			} else if (selectedTipeAkun === 'Panitia Kesekretariatan') {
				$('.nim').show();
				$('.nopendaftaran').hide();
				$('.namalengkap').show();
				$('.jeniskelamin').show();
				$('.programstudi').show();
				$('.alamat').show();
				$('.notelepon').show();
				$('.email').show();
				$('.kategori').hide();
				$('.role').show();
				$('.katasandi').show();
				$('.katasandi2').show();
			}
		});
	});
</script>

<script>
	function daftarakun(event) {
		event.preventDefault();

		var selectedTipeAkun = $('[name="tipeakun"]').val();

		var nim = document.getElementById("nim").value;
		var nopendaftaran = document.getElementById("nopendaftaran").value;
		var namalengkap = document.getElementById("namalengkap").value;
		var jeniskelamin = document.getElementById("jeniskelamin").value;
		var programstudi = document.getElementById("programstudi").value;
		var alamat = document.getElementById("alamat").value;
		var notelepon = document.getElementById("notelepon").value;
		var email = document.getElementById("email").value;
		var kategori = document.getElementById("kategori").value;
		var role = document.getElementById("role").value;
		var katasandi = document.getElementById("katasandi").value;
		var katasandi2 = document.getElementById("katasandi2").value;

		// ... (tindakan sesuai dengan tipe akun dan validasi lainnya)

		if (katasandi == katasandi2) {
			// Adjust the URL, method, and data based on the selected account type
			var url = "";
			var method = "";
			var data = {};

			if (selectedTipeAkun === 'Mahasiswa Baru') {
				url = "https://localhost:7087/daftarmahasiswa";
				method = "POST";
				data = {
					mhs_nopendaftaran: nopendaftaran,
					mhs_namalengkap: namalengkap,
					mhs_gender: jeniskelamin,
					mhs_programstudi: programstudi,
					mhs_alamat: alamat,
					mhs_notelepon: notelepon,
					mhs_email: email,
					mhs_kategori: kategori,
					mhs_password: katasandi,
					mhs_status: "Menunggu Verifikasi",
					mhs_idkelompok: "",
					mhs_idpkkmb: "",
					mhs_statuskelulusan: "",
					mhs_saran: "",
					mhs_kritik: "",
					mhs_insight: "",
					mhs_tglkirimevaluasi: "",
				};
			} else if (selectedTipeAkun === 'Panitia Kesekretariatan') {
				url = "https://localhost:7087/daftarksk";
				method = "POST";
				data = {
					ksk_nim: nim,
					ksk_nama: namalengkap,
					ksk_jeniskelamin: jeniskelamin,
					ksk_programstudi: programstudi,
					ksk_alamat: alamat,
					ksk_notelepon: notelepon,
					ksk_email: email,
					ksk_role: role,
					ksk_password: katasandi,
					ksk_status: "Menunggu Verifikasi",
				};
			}

			$.ajax({
				url: url,
				method: method,
				data: JSON.stringify(data),
				contentType: "application/json",
				success: function (data) {
					alert("Akun Berhasil Terbuat");
					window.location.href = '..'; // Redirect to the desired URL
				},
				error: function (xhr, status, error) {
					console.error("AJAX request error:", status, error);
					console.log("Server response:", xhr.responseText);
				},
			});
		} else {
			alert("Kata Sandi Tidak Cocok!");
		}
	}
</script>

